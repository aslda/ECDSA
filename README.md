# ECDSA
## 题目: 假装是佐藤
#### 如下切入点：  
• 泄漏𝑘 导致泄漏𝑑  
• 重复使用𝑘 导致泄漏𝑑  
• 两个用户，使用𝑘 导致泄漏𝑑, 也就是说他们可以推断出彼此的𝑑 • ECDSA的延展性，例如。𝑟, 𝑠 和𝑟,−𝑠 都是有效签名  

---

### 椭圆曲线数字签名算法
##### 私钥的生成
• 随机在 (1，n−1)区间取整数da作为私钥  
• n是椭圆曲线的order，也就是椭圆曲线加密方程模数    

##### 公钥的生成
• Q = da ∗ G ，其中Q是公钥，也就是说这里公钥是通过私钥生成的，而G是椭圆曲线上的基点。(注意: 等式的乘法是椭圆曲线加密中的乘法)  

### 签名
• 生成临时密钥k  
• 计算 P = k ∗ G,其中P是椭圆曲线上的点  
• 取P点x坐标，r ≡ x (mod n)   
• 使用SHA1函数计算message的哈希值，使用H(m)表示  
• s ≡ k^(-1)∗ (H(m)+dA∗r)(mod n) ,最终得到的(r,s)为签名算法的输出结果  

---

代码包括进行攻击的具体实行，进行签名伪造，签名伪造结果验证，检测攻击是否成功。运行代码之前需要安装ecdsa与hashlib两个库。  
